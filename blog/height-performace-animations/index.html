<!doctype html>
<html lang="ko" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.15">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Kooku log RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Kooku log Atom Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-KVSM4B0KPY"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-KVSM4B0KPY",{})</script><title data-react-helmet="true">Height Performace Animations | Kooku log</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://kooku0.gihub.io/blog/height-performace-animations/"><meta data-react-helmet="true" name="docusaurus_locale" content="ko"><meta data-react-helmet="true" name="docusaurus_tag" content="default"><meta data-react-helmet="true" property="og:title" content="Height Performace Animations | Kooku log"><meta data-react-helmet="true" name="description" content="rendering-process"><meta data-react-helmet="true" property="og:description" content="rendering-process"><meta data-react-helmet="true" property="og:type" content="article"><meta data-react-helmet="true" property="article:published_time" content="2021-05-13T00:00:00.000Z"><meta data-react-helmet="true" property="article:tag" content="web"><link data-react-helmet="true" rel="icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://kooku0.gihub.io/blog/height-performace-animations/"><link data-react-helmet="true" rel="alternate" href="https://kooku0.gihub.io/en/blog/height-performace-animations/" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://kooku0.gihub.io/blog/height-performace-animations/" hreflang="ko"><link data-react-helmet="true" rel="alternate" href="https://kooku0.gihub.io/blog/height-performace-animations/" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.5b7f8d25.css">
<link rel="preload" href="/assets/js/runtime~main.694da26a.js" as="script">
<link rel="preload" href="/assets/js/main.a02d3387.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">본문으로 건너뛰기</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/favicon.ico" alt="My Site Logo" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/img/favicon.ico" alt="My Site Logo" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title">Kooku&#x27;s log</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog/">블로그</a><a class="navbar__item navbar__link" href="/docs/books/">책</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/kooku0/kooku0.github.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_Pssr toggle_TdHA toggleDisabled_jDku"><div class="toggleTrack_SSoT" role="button" tabindex="-1"><div class="toggleTrackCheck_XobZ"><span class="toggleIcon_eZtF">🌜</span></div><div class="toggleTrackX_YkSC"><span class="toggleIcon_eZtF">🌞</span></div><div class="toggleTrackThumb_uRm4"></div></div><input type="checkbox" class="toggleScreenReader_JnkT" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper blog-wrapper blog-post-page"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_a9qW thin-scrollbar" aria-label="최근 블로그 문서 둘러보기"><div class="sidebarItemTitle_uKok margin-bottom--md">Recent posts</div><ul class="sidebarItemList_Kvuv"><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/blog/컴포넌트를-어떻게-만들어야할까/">컴포넌트를 어떻게 만들어야 할까?</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/blog/프론트엔드에서-테스트코드 짜기/">프론트엔드에서 테스트코드 짜기</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/blog/컴포넌트-응집도/">컴포넌트 응집도</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/blog/react에서-side-effect를-관리하는-법/">React에서 side effect를 관리하는 법</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/blog/마이크로서비스-아키텍처를-모노레포로-관리하기/">마이크로서비스 아키텍처를 모노레포로 관리하기</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h1 class="blogPostTitle_rzP5" itemprop="headline">Height Performace Animations</h1><div class="blogPostData_Zg1s margin-vert--md"><time datetime="2021-05-13T00:00:00.000Z" itemprop="datePublished">2021년 5월 13일</time> · <!-- -->약 7분</div></header><div id="post-content" class="markdown" itemprop="articleBody"><p><img alt="rendering-process" src="/assets/images/rendering-process-df6098189e6da4de6917738ddce316fb.jpeg" width="1093" height="167"></p><blockquote><p>출처: <a href="https://developers.google.com/web/fundamentals/performance/rendering/?hl=ko" target="_blank" rel="noopener noreferrer">developers.google.com</a></p></blockquote><p>JS와 CSS를 이용하여 animation을 구현해야할 때 성능 상 가장 고려해야할 부분이 Reflow(Layout) 와 Repaint(Paint)를 최소화하는 것이다.</p><p><img alt="rendering-process-2" src="/assets/images/rendering-process-2-5a30aaabdb082a67887bfea4f26bfe58.gif" width="600" height="375"></p><small> DOM 트리 및 스타일, 레이아웃 트리, 페인트 트리의 순서로 생성된다</small><p>렌더링 파이프라인에서 파악해야 할 가장 중요한 점은 각 단계에서 이전 작업의 결과가 새 데이터를 만드는 데 사용된다는 것이다. 예를 들어 레이아웃 트리에서 변경이 생겨 문서의 일부가 영향을 받으면 페인팅 순서도 새로 생성해야 한다.</p><p>요소에 애니메이션을 적용하면 브라우저는 모든 프레임 사이에서 이러한 작업을 해야 한다. 대부분의 디스플레이 장치는 화면을 초당 60번 새로 고친다(60fps). 요소의 움직임이 모든 프레임에 반영되어야 사람이 볼 때 부드럽게 느껴진다. 애니메이션에서 프레임이 누락되면 웹 페이지가 &#x27;버벅대는(janky)&#x27; 것처럼 보인다.</p><p>화면 주사율에 맞추어 렌더링 작업이 이루어져도 이 작업은 메인 스레드에서 실행되기 때문에 애플리케이션이 JavaScript를 실행하는 동안 렌더링이 막힐 수 있다.
JavaScript 작업을 작은 덩어리로 나누고 <code>requestAnimationFrame()</code> 메서드를 사용해 프레임마다 실행하도록 스케줄을 관리할 수 있다.  하지만 이건 JavaScript의 실행을 끊김없이 하는데 도움을 줄 뿐 실제로 메인쓰레드가 수행하는 작업의 양은 줄어들지 않는다.
메인쓰레드가 수행하는 작업의 양을 줄이는 작업이 바로 Reflow와 Repaint를 최소화하는 것이다.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="reflowlayout">Reflow(Layout)<a class="hash-link" href="#reflowlayout" title="제목으로 바로 가기">​</a></h2><p>DOM Tree 와 CSSOM로 만든 Render Tree를 바탕으로 DOM을 Viewport 내에 놓일 정확한 위치와 크기를 계산하여 적용하는 단계이다.
이 단계에서는 해당 DOM의 크기와 위치를 계산할 시 주변 노드(부모, 자식)들에 영향을 받게 된다. 따라서 이미 계산된 Layout에서 한 노드만 다시 계산하여도 주변 모든 노드들도 다시 계산하게 된다.
css 에서 다음의 속성들을 건드리게 되면 Reflow단계를 수행하게 된다.</p><ul><li>padding</li><li>margin</li><li>display</li><li>border</li><li>position</li><li>float</li><li>overflow</li><li>font-family</li><li>vertical-align</li><li>clear</li><li>bottom</li><li>left</li><li>right</li><li>font-weight</li><li>white-space</li><li>etc..</li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="repaintpaint">Repaint(Paint)<a class="hash-link" href="#repaintpaint" title="제목으로 바로 가기">​</a></h2><p>Layout에서 계산된 결과를 바탕으로 Viewport에서 픽셀을 채워넣는 단계이다.
밑의 속성들이 변경되면 Repaint 단계가 일어난다.</p><ul><li>Visibility</li><li>background</li><li>text-decoration</li><li>background-image</li><li>background-repeat</li><li>border0radius</li><li>box-shadow</li><li>background-size</li><li>etc...</li></ul><p>만약 기존 CSS에서 background-color만 바꾸게 된다면 Reflow단계를 건너뛰고 Repaint단계만 수행하게 된다.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="composite">Composite<a class="hash-link" href="#composite" title="제목으로 바로 가기">​</a></h2><p>opacity, transform등의 속성은 Reflow, Repaint 단계를 거치지 않는다.
Reflow, Repaint를 모두 건너 뛰게 되어 연산이 절대적으로 줄게 된다.
따라서 animation을 구현할 때 transform을 통해서 구현하는 것이 성능 상에 이점이 많다.</p><p>특히나 Composite의 이점은 메인 스레드와 별개로 작동이 된다. Compositor thread는 JavaScript 실행이나 스타일 계산을 기다리지 않아, Composite만 하는 animation이 성능상 가장 부드럽다고 보는 이유이다.
(Layout이나 Paint를 다시 계산해야할 경우에는 main thread가 관여하게 된다.)</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="정리">정리<a class="hash-link" href="#정리" title="제목으로 바로 가기">​</a></h2><p>animation 성능을 향상(부드러운 animation)시키기 위해서는 Reflow와 Repaint를 최소화하는게 중요하다.
width, height, left, right등의 요소를 사용하기 보다는 다음의 네가지 요소를 이용해서 animation을 구현하자.</p><ul><li>opacity</li><li>translate</li><li>rotate</li><li>scale</li></ul><p>실제로 React나 Vue에서 Virtual Dom을 사용하는 이유가 Reflow, Repaint를 여러번 하지않고, 모아서 한꺼번에 처리해 성능을 높히기 위함이다.</p><p>경우에 따라서는 Reflow를 해야만 하는 경우가 있다. 이러한 경우에는 해당 node를 position: absolute or fixed로 변경하는게 좋다. 그 이유는 Reflow를 사용할 시 부모, 자식등 영향을 받는 모든 node들이 계산하게 되는데, absolute, fixed일 경우 부모에게 종속되지 않는 새로운 layer에 그려지게 된다.</p><p>따라서 만약 해당 node에 reflow가 발생하게 된다면 해당 layer만 새로 업데이트 된다.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="reference">Reference<a class="hash-link" href="#reference" title="제목으로 바로 가기">​</a></h3><ul><li><a href="https://csstriggers.com/" target="_blank" rel="noopener noreferrer">Reflow, Repaint, Composit에 영향을 미치는 속성들을 더 알고싶다면 여기를 참고하자</a></li><li><a href="https://developers.google.com/web/fundamentals/performance/rendering/?hl=ko" target="_blank" rel="noopener noreferrer">Rendering process &amp; performance에 대한 내용</a></li><li><a href="https://developers.google.com/web/fundamentals/performance/critical-rendering-path/render-tree-construction?hl=en" target="_blank" rel="noopener noreferrer">Render-tree Construction, Layout, and Paint</a></li><li><a href="https://www.html5rocks.com/en/tutorials/speed/high-performance-animations/" target="_blank" rel="noopener noreferrer">hight performance animation의 조금 더 깊은 내용</a></li><li><a href="https://d2.naver.com/helloworld/5237120" target="_blank" rel="noopener noreferrer">최신 브라우저의 내부 살펴보기</a></li></ul></div><footer class="row docusaurus-mt-lg blogPostDetailsFull_h6_j"><div class="col"><b>태그:</b><ul class="tags_XVD_ padding--none margin-left--sm"><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/blog/tags/web/">web</a></li></ul></div><div class="col margin-top--sm"><a href="https://github.com/kooku0/kooku0.github.io/edit/main/blog/height-performace-animations.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dcUD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>페이지 편집</a></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="블로그 게시물 탐색"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/blog/web-vitals/"><div class="pagination-nav__sublabel">이전 게시물</div><div class="pagination-nav__label">Web Vitals</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/blog/execution-context/"><div class="pagination-nav__sublabel">다음 게시물</div><div class="pagination-nav__label">Execution Context</div></a></div></nav></main><div class="col col--2"><div class="tableOfContents_cNA8 thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#reflowlayout" class="table-of-contents__link toc-highlight">Reflow(Layout)</a></li><li><a href="#repaintpaint" class="table-of-contents__link toc-highlight">Repaint(Paint)</a></li><li><a href="#composite" class="table-of-contents__link toc-highlight">Composite</a></li><li><a href="#정리" class="table-of-contents__link toc-highlight">정리</a><ul><li><a href="#reference" class="table-of-contents__link toc-highlight">Reference</a></li></ul></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/blog/">블로그</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/books/">책</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/kooku0/kooku0.github.io" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 kooku's log, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.694da26a.js"></script>
<script src="/assets/js/main.a02d3387.js"></script>
</body>
</html>