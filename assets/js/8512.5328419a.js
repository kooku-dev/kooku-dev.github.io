"use strict";(self.webpackChunkkooku_log=self.webpackChunkkooku_log||[]).push([[8512],{3341:e=>{e.exports=function e(n,t){if(n===t)return!0;if(n&&t&&"object"==typeof n&&"object"==typeof t){if(n.constructor!==t.constructor)return!1;var o,r,u;if(Array.isArray(n)){if((o=n.length)!=t.length)return!1;for(r=o;0!=r--;)if(!e(n[r],t[r]))return!1;return!0}if(n.constructor===RegExp)return n.source===t.source&&n.flags===t.flags;if(n.valueOf!==Object.prototype.valueOf)return n.valueOf()===t.valueOf();if(n.toString!==Object.prototype.toString)return n.toString()===t.toString();if((o=(u=Object.keys(n)).length)!==Object.keys(t).length)return!1;for(r=o;0!=r--;)if(!Object.prototype.hasOwnProperty.call(t,u[r]))return!1;for(r=o;0!=r--;){var i=u[r];if(!e(n[i],t[i]))return!1}return!0}return n!=n&&t!=t}},48512:(e,n,t)=>{t.d(n,{y:()=>m});function o(e,n){var t={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&n.indexOf(o)<0&&(t[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(e);r<o.length;r++)n.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(e,o[r])&&(t[o[r]]=e[o[r]])}return t}function r(e,n,t,o){return new(t||(t=Promise))((function(r,u){function i(e){try{a(o.next(e))}catch(n){u(n)}}function c(e){try{a(o.throw(e))}catch(n){u(n)}}function a(e){var n;e.done?r(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(i,c)}a((o=o.apply(e,n||[])).next())}))}function u(e,n){var t,o,r,u,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return u={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(u[Symbol.iterator]=function(){return this}),u;function c(c){return function(a){return function(c){if(t)throw new TypeError("Generator is already executing.");for(;u&&(u=0,c[0]&&(i=0)),i;)try{if(t=1,o&&(r=2&c[0]?o.return:c[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,c[1])).done)return r;switch(o=0,r&&(c=[2&c[0],r.value]),c[0]){case 0:case 1:r=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,o=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(r=i.trys,(r=r.length>0&&r[r.length-1])||6!==c[0]&&2!==c[0])){i=0;continue}if(3===c[0]&&(!r||c[1]>r[0]&&c[1]<r[3])){i.label=c[1];break}if(6===c[0]&&i.label<r[1]){i.label=r[1],r=c;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(c);break}r[2]&&i.ops.pop(),i.trys.pop();continue}c=n.call(e,i)}catch(a){c=[6,a],o=0}finally{t=r=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,a])}}}Object.create;function i(e,n){var t="function"==typeof Symbol&&e[Symbol.iterator];if(!t)return e;var o,r,u=t.call(e),i=[];try{for(;(void 0===n||n-- >0)&&!(o=u.next()).done;)i.push(o.value)}catch(c){r={error:c}}finally{try{o&&!o.done&&(t=u.return)&&t.call(u)}finally{if(r)throw r.error}}return i}function c(e,n,t){if(t||2===arguments.length)for(var o,r=0,u=n.length;r<u;r++)!o&&r in n||(o||(o=Array.prototype.slice.call(n,0,r)),o[r]=n[r]);return e.concat(o||Array.prototype.slice.call(n))}Object.create;"function"==typeof SuppressedError&&SuppressedError;var a=t(50959),l=t(3341),f=t.n(l);function s(e,n){return void 0===n&&(n=!1),r(this,void 0,void 0,(function(){return u(this,(function(t){return document.querySelector('[src="'+e+'"]')?[2]:(p(n,"Injecting SDK script..."),[2,new Promise((function(n,t){var o=document.createElement("script");o.src=e,o.async=!0,o.defer=!0,o.onload=function(){n(),o.onload=null,o.onerror=null},o.onerror=function(){t(new Error("Fail to inject SDK script.")),o.onload=null,o.onerror=null},document.head.appendChild(o)}))])}))}))}function d(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];console.warn.apply(console,c(["[ReactChannelIO]"],i(e)))}function p(e){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t];e&&console.debug.apply(console,c(["\u2699\ufe0f [ReactChannelIO - debug]"],i(n)))}var h=function(e){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t];"undefined"!=typeof window&&("function"==typeof window.ChannelIO?window.ChannelIO.apply(window,c([e],i(n))):d("ChannelIO instance is not initalized yet."))},v=(0,a.createContext)(null),g=["onBoot","onShowMessenger","onShow","onHideMessenger","onHide","onBadgeChanged","onChangeBadge","onChatCreated","onCreateChat","onProfileChanged","onChangeProfile","onUrlClicked","onClickRedirect"];var b=function(e){return function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];document.dispatchEvent(new(function(){if("function"==typeof window.CustomEvent)return window.CustomEvent;var e=function(e,n){var t,o,r;document.createEvent("CustomEvent").initCustomEvent(e,null!==(t=null==n?void 0:n.bubbles)&&void 0!==t&&t,null!==(o=null==n?void 0:n.cancelable)&&void 0!==o&&o,null!==(r=null==n?void 0:n.detail)&&void 0!==r?r:void 0)};return e.prototype=window.Event.prototype,window.CustomEvent=e,window.CustomEvent}())("react-channelio-evt",{detail:{method:e,args:n}}))}},y="data-channel-plugin",w="launcher",m=function(e){var n,t,l,m,C,O=e.children,E=e.autoBoot,S=void 0!==E&&E,k=e.autoBootTimeout,j=void 0===k?1e3:k,B=e.rebootOnOptionChanged,x=void 0===B||B,P=e.useCustomLauncherSelectorTweak,A=void 0===P||P,I=e.verbose,L=void 0!==I&&I,R=e.onBoot,T=o(e,["children","autoBoot","autoBootTimeout","rebootOnOptionChanged","useCustomLauncherSelectorTweak","verbose","onBoot"]),M=(n=R,t=(0,a.useRef)(n),(0,a.useEffect)((function(){t.current=n}),[n]),t),q=(0,a.useRef)(T),H=i(a.useState(!1),2),U=H[0],D=H[1],F=(0,a.useCallback)((function(){return r(void 0,void 0,void 0,(function(){return u(this,(function(e){return[2,new Promise((function(e,n){try{g.forEach((function(e){h(e,b(e))})),p(L,"Booting plugin..."),p(L,"boot options =>",q.current),h("boot",q.current,(function(t,o){if("function"==typeof M.current&&M.current(t,o),t)return d("Error occurred while boot plugin.",t),D(!1),void n(t);var r={};(null==o?void 0:o.language)!==q.current.language&&(r.language=q.current.language),null===q.current.profile&&(r.profile=null),h("updateUser",r,(function(e,n){e?d("Fail to reset user information of plugin."):p(L,"User updated after booting",n)})),p(L,"Booted"),D(!0),e(o)}))}catch(t){n(t)}}))]}))}))}),[L,M]),K=(0,a.useCallback)((function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];p(L,"Shuting down plugin..."),h("clearCallbacks"),h.apply(void 0,c(["shutdown"],i(e))),D(!1)}),[L]);return(0,a.useEffect)((function(){return p(L,"Bootstraping plugin...","(Set verbose flag `false`, to remove these debugging logs)"),r(void 0,void 0,void 0,(function(){return u(this,(function(e){switch(e.label){case 0:return e.trys.push([0,5,,6]),function(){if(!window.ChannelIO){p(L,"Creating plugin queue...");var e=function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];e.c(n)};e.q=[],e.c=function(n){e.q.push(n)},window.ChannelIO=e}}(),[4,s("https://cdn.channel.io/plugin/ch-plugin-web.js",L)];case 1:return e.sent(),p(L,"Auto boot flag set as",S),S?[4,new Promise((function(e){return setTimeout(e,j)}))]:[3,4];case 2:return e.sent(),p(L,"Auto Booting..."),[4,F().catch((function(){}))];case 3:e.sent(),e.label=4;case 4:return[3,6];case 5:return d("Error occurred at plugin boot processing on first mount.",e.sent()),[3,6];case 6:return[2]}}))})),function(){K()}}),[]),(0,a.useEffect)((function(){q.current=T}),[T]),l=function(){U&&x&&(p(L,"Rebooting since option has been changed..."),F().catch((function(){})))},m=[T],(C=(0,a.useRef)(void 0)).current&&f()(m,C.current)||(C.current=m),(0,a.useEffect)(l,C.current),(0,a.useEffect)((function(){var e=T.customLauncherSelector;if(A&&e){var n=new MutationObserver((function(n){n.filter((function(e){return"childList"===e.type})).filter((function(e){return e.target instanceof HTMLElement})).map((function(n){return n.target.querySelectorAll(e)})).forEach((function(e){return Array.from(e).filter((function(e){return e instanceof HTMLElement})).forEach((function(e){var n=e;n.getAttribute(y)!==w&&(n.setAttribute(y,w),n.addEventListener("click",(function(){return h("showMessenger")}),!1))}))}))}));return n.observe(document.body,{attributes:!1,childList:!0,subtree:!0}),function(){n.disconnect()}}}),[T.customLauncherSelector,A]),a.createElement(v.Provider,{value:{isBooted:U,boot:F,shutdown:K}},O)}}}]);