"use strict";(self.webpackChunkkooku_log=self.webpackChunkkooku_log||[]).push([[3040],{4063:function(n){n.exports=function n(e,t){if(e===t)return!0;if(e&&t&&"object"==typeof e&&"object"==typeof t){if(e.constructor!==t.constructor)return!1;var o,r,u;if(Array.isArray(e)){if((o=e.length)!=t.length)return!1;for(r=o;0!=r--;)if(!n(e[r],t[r]))return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===t.toString();if((o=(u=Object.keys(e)).length)!==Object.keys(t).length)return!1;for(r=o;0!=r--;)if(!Object.prototype.hasOwnProperty.call(t,u[r]))return!1;for(r=o;0!=r--;){var i=u[r];if(!n(e[i],t[i]))return!1}return!0}return e!=e&&t!=t}},3040:function(n,e,t){t.d(e,{y:function(){return C}});function o(n,e,t,o){return new(t||(t=Promise))((function(r,u){function i(n){try{a(o.next(n))}catch(e){u(e)}}function c(n){try{a(o.throw(n))}catch(e){u(e)}}function a(n){var e;n.done?r(n.value):(e=n.value,e instanceof t?e:new t((function(n){n(e)}))).then(i,c)}a((o=o.apply(n,e||[])).next())}))}function r(n,e){var t,o,r,u,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return u={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(u[Symbol.iterator]=function(){return this}),u;function c(u){return function(c){return function(u){if(t)throw new TypeError("Generator is already executing.");for(;i;)try{if(t=1,o&&(r=2&u[0]?o.return:u[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,u[1])).done)return r;switch(o=0,r&&(u=[2&u[0],r.value]),u[0]){case 0:case 1:r=u;break;case 4:return i.label++,{value:u[1],done:!1};case 5:i.label++,o=u[1],u=[0];continue;case 7:u=i.ops.pop(),i.trys.pop();continue;default:if(!(r=i.trys,(r=r.length>0&&r[r.length-1])||6!==u[0]&&2!==u[0])){i=0;continue}if(3===u[0]&&(!r||u[1]>r[0]&&u[1]<r[3])){i.label=u[1];break}if(6===u[0]&&i.label<r[1]){i.label=r[1],r=u;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(u);break}r[2]&&i.ops.pop(),i.trys.pop();continue}u=e.call(n,i)}catch(c){u=[6,c],o=0}finally{t=r=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,c])}}}Object.create;function u(n,e){var t="function"==typeof Symbol&&n[Symbol.iterator];if(!t)return n;var o,r,u=t.call(n),i=[];try{for(;(void 0===e||e-- >0)&&!(o=u.next()).done;)i.push(o.value)}catch(c){r={error:c}}finally{try{o&&!o.done&&(t=u.return)&&t.call(u)}finally{if(r)throw r.error}}return i}function i(n,e,t){if(t||2===arguments.length)for(var o,r=0,u=e.length;r<u;r++)!o&&r in e||(o||(o=Array.prototype.slice.call(e,0,r)),o[r]=e[r]);return n.concat(o||Array.prototype.slice.call(e))}Object.create;var c=t(7294),a=t(4063),l=t.n(a);function f(){return"undefined"==typeof window}function s(n,e){return void 0===e&&(e=!1),o(this,void 0,void 0,(function(){return r(this,(function(t){return document.querySelector('[src="'+n+'"]')?[2]:(p(e,"Injecting SDK script..."),[2,new Promise((function(e,t){var o=document.createElement("script");o.src=n,o.async=!0,o.defer=!0,o.onload=function(){e(),o.onload=null,o.onerror=null},o.onerror=function(){t(new Error("Fail to inject SDK script.")),o.onload=null,o.onerror=null},document.head.appendChild(o)}))])}))}))}function d(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];console.warn.apply(console,i(["[ReactChannelIO]"],u(n)))}function p(n){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];n&&console.debug.apply(console,i(["\u2699\ufe0f [ReactChannelIO - debug]"],u(e)))}var h=function(n){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];f()||("function"==typeof window.ChannelIO?window.ChannelIO.apply(window,i([n],u(e))):d("ChannelIO instance is not initalized yet."))},v=(0,c.createContext)(null),g="react-channelio-evt",b=["onBoot","onShowMessenger","onShow","onHideMessenger","onHide","onBadgeChanged","onChangeBadge","onChatCreated","onCreateChat","onProfileChanged","onChangeProfile","onUrlClicked","onClickRedirect"],y=function(){if("function"==typeof window.CustomEvent)return window.CustomEvent;var n=function(n,e){var t,o,r;document.createEvent("CustomEvent").initCustomEvent(n,null!==(t=null==e?void 0:e.bubbles)&&void 0!==t&&t,null!==(o=null==e?void 0:e.cancelable)&&void 0!==o&&o,null!==(r=null==e?void 0:e.detail)&&void 0!==r?r:void 0)};return n.prototype=window.Event.prototype,window.CustomEvent=n,window.CustomEvent};var w="data-channel-plugin",m="launcher",C=function(n){var e,t,a,f,C,O=n.children,E=n.autoBoot,S=void 0!==E&&E,k=n.autoBootTimeout,j=void 0===k?1e3:k,B=n.rebootOnOptionChanged,x=void 0===B||B,P=n.useCustomLauncherSelectorTweak,A=void 0===P||P,I=n.verbose,L=void 0!==I&&I,R=n.onBoot,T=function(n,e){var t={};for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&e.indexOf(o)<0&&(t[o]=n[o]);if(null!=n&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(n);r<o.length;r++)e.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(n,o[r])&&(t[o[r]]=n[o[r]])}return t}(n,["children","autoBoot","autoBootTimeout","rebootOnOptionChanged","useCustomLauncherSelectorTweak","verbose","onBoot"]),M=(e=R,t=(0,c.useRef)(e),(0,c.useEffect)((function(){t.current=e}),[e]),t),q=(0,c.useRef)(T),H=u(c.useState(!1),2),U=H[0],D=H[1],F=function(){b.forEach((function(n){h(n,function(n){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];document.dispatchEvent(new(y())(g,{detail:{method:n,args:e}}))}}(n))}))},K=(0,c.useCallback)((function(){return o(void 0,void 0,void 0,(function(){return r(this,(function(n){return[2,new Promise((function(n,e){try{F(),p(L,"Booting plugin..."),p(L,"boot options =>",q.current),h("boot",q.current,(function(t,o){if("function"==typeof M.current&&M.current(t,o),t)return d("Error occurred while boot plugin.",t),D(!1),void e(t);var r={};(null==o?void 0:o.language)!==q.current.language&&(r.language=q.current.language),null===q.current.profile&&(r.profile=null),h("updateUser",r,(function(n,e){n?d("Fail to reset user information of plugin."):p(L,"User updated after booting",e)})),p(L,"Booted"),D(!0),n(o)}))}catch(t){e(t)}}))]}))}))}),[L,M]),_=(0,c.useCallback)((function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];p(L,"Shuting down plugin..."),h("clearCallbacks"),h.apply(void 0,i(["shutdown"],u(n))),D(!1)}),[L]);return(0,c.useEffect)((function(){return p(L,"Bootstraping plugin...","(Set verbose flag `false`, to remove these debugging logs)"),o(void 0,void 0,void 0,(function(){return r(this,(function(n){switch(n.label){case 0:return n.trys.push([0,5,,6]),function(){if(!window.ChannelIO){p(L,"Creating plugin queue...");var n=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];n.c(e)};n.q=[],n.c=function(e){n.q.push(e)},window.ChannelIO=n}}(),[4,s("https://cdn.channel.io/plugin/ch-plugin-web.js",L)];case 1:return n.sent(),p(L,"Auto boot flag set as",S),S?[4,new Promise((function(n){return setTimeout(n,j)}))]:[3,4];case 2:return n.sent(),p(L,"Auto Booting..."),[4,K().catch((function(){}))];case 3:n.sent(),n.label=4;case 4:return[3,6];case 5:return d("Error occurred at plugin boot processing on first mount.",n.sent()),[3,6];case 6:return[2]}}))})),function(){_()}}),[]),(0,c.useEffect)((function(){q.current=T}),[T]),a=function(){U&&x&&(p(L,"Rebooting since option has been changed..."),K().catch((function(){})))},f=[T],(C=(0,c.useRef)(void 0)).current&&l()(f,C.current)||(C.current=f),(0,c.useEffect)(a,C.current),(0,c.useEffect)((function(){var n=T.customLauncherSelector;if(A&&n){var e=new MutationObserver((function(e){e.filter((function(n){return"childList"===n.type})).filter((function(n){return n.target instanceof HTMLElement})).map((function(e){return e.target.querySelectorAll(n)})).forEach((function(n){return Array.from(n).filter((function(n){return n instanceof HTMLElement})).forEach((function(n){var e=n;e.getAttribute(w)!==m&&(e.setAttribute(w,m),e.addEventListener("click",(function(){return h("showMessenger")}),!1))}))}))}));return e.observe(document.body,{attributes:!1,childList:!0,subtree:!0}),function(){e.disconnect()}}}),[T.customLauncherSelector,A]),c.createElement(v.Provider,{value:{isBooted:U,boot:K,shutdown:_}},O)}}}]);