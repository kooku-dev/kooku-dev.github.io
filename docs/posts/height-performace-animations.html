<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="viewport" content="width=device-width,initial-scale=1.0,user-scalable=no"/><link rel="shortcut icon" href="/favicon.ico"/><script>
            (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
            new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
            j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
            'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
            })(window,document,'script','dataLayer','GTM-KDDR59L');
              </script><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-88SF4487LG"></script><script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());

            gtag('config', 'G-88SF4487LG');
              </script><title>Kooku&#x27;s log - Height Performace Animations</title><meta property="og:logo" content="https://kooku94.github.io/favicon.ico"/><meta property="og:title" content="Height Performace Animations"/><meta property="og:image" content="https://kooku94.github.ioundefined"/><meta property="og:image:width" content="1200"/><meta property="og:image:height" content="630"/><meta property="og:type" content="article"/><meta name="next-head-count" content="14"/><noscript data-n-css=""></noscript><link rel="preload" href="/_next/static/chunks/main-700352a82f2f881da0df.js" as="script"/><link rel="preload" href="/_next/static/chunks/webpack-50bee04d1dc61f8adf5b.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework.bcd77fe60d2cafeaf060.js" as="script"/><link rel="preload" href="/_next/static/chunks/commons.41740424e3c7ae16de33.js" as="script"/><link rel="preload" href="/_next/static/chunks/6335da8543c52d3af527c387f688061357787349.024b674f35d94beaf7c8.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/_app-9ca66668ed02ba88465c.js" as="script"/><link rel="preload" href="/_next/static/chunks/b2e984c5.dde205419b836c367968.js" as="script"/><link rel="preload" href="/_next/static/chunks/2c3b9bffc7150b37a7b3810dfcf1c0b0fac2bd18.00ed53c325f730cbfd70.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/posts/%5Bslug%5D-83b8a4f787f45e6aa6dc.js" as="script"/></head><body><div id="__next"><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KDDR59L" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><style data-emotion="css-global 1g30n2o">*{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;box-sizing:border-box;}html,body{font-family:'Spoqa Han Sans Neo',sans-serif!important;margin:0;padding:0;border:0;}html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,menu,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td,article,aside,canvas,details,embed,figure,figcaption,footer,header,hgroup,main,menu,nav,output,ruby,section,summary,time,mark,audio,video{margin:0;padding:0;border:0;vertical-align:baseline;}article,aside,details,figcaption,figure,footer,header,hgroup,main,menu,nav,section{display:block;}*[hidden]{display:none;}body{line-height:1;}input::-ms-clear,input::-ms-reveal{display:none;width:0;height:0;}input::-webkit-search-decoration,input::-webkit-search-cancel-button,input::-webkit-search-results-button,input::-webkit-search-results-decoration{display:none;}*:active{-webkit-tap-highlight-color:transparent;outline:none;}*:focus{outline:0;}a{-webkit-text-decoration:none;text-decoration:none;}input[type='number']::-webkit-outer-spin-button,input[type='number']::-webkit-inner-spin-button{-webkit-appearance:none;margin:0;}button,*[role='button']{cursor:pointer;}</style><style data-emotion="css bjn8wh">.css-bjn8wh{position:relative;}</style><div class="css-bjn8wh ep629fi11"><style data-emotion="css 1mwsm5">.css-1mwsm5{background:linear-gradient(72deg, #6ecaf5, #e7c6f1);position:-webkit-sticky;position:sticky;left:0;right:0;top:0;z-index:999;}</style><div class="css-1mwsm5 e1ohtyx52"><style data-emotion="css 1518suw">.css-1518suw{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;height:60px;}@media (min-width: 1024px){.css-1518suw{max-width:1024px;margin:0 auto;}}@media (min-width: 768px) and (max-width: 1023px){.css-1518suw{max-width:960px;margin:0 32px;}}@media (max-width: 767px){.css-1518suw{max-width:100%;margin:0 16px;}}</style><nav class="css-1518suw e1ohtyx51"><style data-emotion="css itptq8">.css-itptq8{color:#ffffff;opacity:0.7;font-size:28px;font-weight:800;}</style><h3 role="button" tabindex="0" class="css-itptq8 e1ohtyx50">Kooku&#x27;s log</h3><style data-emotion="css 1p39xhz">.css-1p39xhz{float:right;padding:14px;opacity:0.6;}</style><a href="https://github.com/kooku94" aria-label="GitHub" class="css-1p39xhz"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"></path></svg></a></nav></div><article class="css-0 ep629fi9"><style data-emotion="css 1cfjemv">.css-1cfjemv{position:relative;padding-bottom:32px;}@media (min-width: 1024px){.css-1cfjemv{max-width:780px;margin:0 auto;}}@media (min-width: 768px) and (max-width: 1023px){.css-1cfjemv{max-width:780px;margin:0 32px;}}@media (max-width: 767px){.css-1cfjemv{max-width:100%;}}@media (max-width: 767px){.css-1cfjemv{margin:0 16px;}}</style><section class="css-1cfjemv ep629fi8"><style data-emotion="css 1d0nbku">.css-1d0nbku{margin-top:24px;}</style><div class="css-1d0nbku ep629fi7"><style data-emotion="css tl449l">.css-tl449l{color:#8d949f;font-size:14px;font-weight:bold;line-height:1.57;margin-right:8px;}</style><span class="css-tl449l ep629fi6">Web</span></div><header><style data-emotion="css ljp8x3">.css-ljp8x3{color:#000000;margin:8px 0 24px 0;font-size:26px;font-weight:bold;line-height:1.2;}</style><h1 class="css-ljp8x3 ep629fi5">Height Performace Animations</h1></header><style data-emotion="css 1829sa1">.css-1829sa1{color:#535a65;font-size:16px;font-weight:normal;line-height:1.63;min-height:320px;}</style><div class="css-1829sa1 ep629fi4"><style data-emotion="css 16cgglh">.css-16cgglh time{color:#9b9b9b;}.css-16cgglh p{line-height:1.5rem;margin:1rem 0 0 0;}.css-16cgglh a{font-size:1rem;color:#358cd6;-webkit-text-decoration:underline;text-decoration:underline;}.css-16cgglh h1{font-size:2rem;margin:2.5rem 0 0 0;}.css-16cgglh h2,.css-16cgglh h3,.css-16cgglh h4,.css-16cgglh h5{margin:1.5rem 0 0.5rem 0;line-height:1.25em;}.css-16cgglh h2::before{position:absolute;margin-left:-1em;font-weight:300;font-size:1.5rem;color:#9b9b9b;display:none;content:'#';}.css-16cgglh img{width:100%;}.css-16cgglh table{max-width:100%;border-spacing:0;margin-top:1.5rem;}.css-16cgglh table thead{background:#f7f7f7;}.css-16cgglh table th{font-weight:500;}.css-16cgglh table th,.css-16cgglh table td{padding:0.5em 1em;border:1px double #eee;}.css-16cgglh ul{list-style-type:disc;}.css-16cgglh ol{list-style-type:decimal;}.css-16cgglh ul ul,.css-16cgglh ol ul{list-style-type:circle;}.css-16cgglh blockquote{border-left:3px solid rgb(239, 240, 244);margin:15px 0;padding-left:16px;}.css-16cgglh blockquote p{margin-top:0;}.css-16cgglh ol,.css-16cgglh ul{padding:0 0 0 1.5rem;margin:1.5rem 0 0 0;margin:0;}.css-16cgglh ol li,.css-16cgglh ul li{line-height:1.5rem;margin:0;}.css-16cgglh .youtube-container{position:relative;width:100%;height:0;padding-bottom:56.25%;overflow:hidden;margin:20px 0;}.css-16cgglh .youtube-container iframe{width:100%;height:100%;position:absolute;top:0;left:0;}.css-16cgglh iframe{position:absolute;top:0;left:0;width:100%;height:100%;}.css-16cgglh p>code{padding:0.1rem 0.3rem;border-radius:4px;background-color:#f2f5fc;color:#275fc8;font-size:1rem;font-weight:bold;}.css-16cgglh pre{padding:1.2em;margin:1.5em 0;overflow:auto;border-radius:0.6em;color:#e0e0e0;background:#212121;font-family:'Consolas','Monaco','Andale Mono','Ubuntu Mono',monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.6;font-size:13px;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;-ms-overflow-style:none;overflow:-moz-scrollbars-none;}.css-16cgglh code[class*='language-'],.css-16cgglh pre[class*='language-']{color:#e0e0e0;background:none;font-family:'Consolas','Monaco','Andale Mono','Ubuntu Mono',monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.6;font-size:13px;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;-ms-overflow-style:none;overflow:-moz-scrollbars-none;}.css-16cgglh pre[class*='language-']::-webkit-scrollbar{display:none;}.css-16cgglh pre[class*='language-']{padding:1.2em;margin:1.5em 0;overflow:auto;border-radius:0.6em;}.css-16cgglh:not(pre)>code[class*='language-'],.css-16cgglh pre[class*='language-']{background:#212121;}.css-16cgglh:not(pre)>code[class*='language-']{padding:0.1em 0.6em;border-radius:0.2em;white-space:normal;background:$inline-dimmed-color;color:$inline-text-color;}.css-16cgglh .token.comment,.css-16cgglh .token.block-comment,.css-16cgglh .token.prolog,.css-16cgglh .token.doctype,.css-16cgglh .token.cdata{color:#868282;}.css-16cgglh .token.punctuation{color:#e0e0e0;}.css-16cgglh pre[class*='language-'] .tag{color:#358cd6;}.css-16cgglh .token.attr-name{color:#6196cc;}.css-16cgglh .token.namespace,.css-16cgglh .token.deleted{color:#e2777a;}.css-16cgglh .token.function-name{color:#6196cc;}.css-16cgglh .token.boolean{color:#358cd6;}.css-16cgglh .token.number{color:#b5ce98;}.css-16cgglh .token.function{color:#dcdcaa;}.css-16cgglh .token.property,.css-16cgglh .token.class-name,.css-16cgglh .token.constant,.css-16cgglh .token.symbol{color:#4ec9b2;}.css-16cgglh .token.selector,.css-16cgglh .token.important,.css-16cgglh .token.atrule,.css-16cgglh .token.keyword,.css-16cgglh .token.builtin{color:#c586c0;}.css-16cgglh .token.string,.css-16cgglh .token.char,.css-16cgglh .token.attr-value,.css-16cgglh .token.regex,.css-16cgglh .token.variable{color:#ce9178;}.css-16cgglh .token.operator,.css-16cgglh .token.entity,.css-16cgglh .token.url{color:#67cdcc;}.css-16cgglh .token.important,.css-16cgglh .token.bold{font-weight:bold;}.css-16cgglh .token.italic{font-style:italic;}.css-16cgglh .token.entity{cursor:help;}.css-16cgglh .token.inserted{color:green;}</style><div class="css-16cgglh ep629fi3"><p><img src="/images/rendering-process.jpeg" alt="rendering-process"></p>
<blockquote>
<p>출처: <a href="https://developers.google.com/web/fundamentals/performance/rendering/?hl=ko">developers.google.com</a></p>
</blockquote>
<p>JS와 CSS를 이용하여 animation을 구현해야할 때 성능 상 가장 고려해야할 부분이 Reflow(Layout) 와 Repaint(Paint)를 최소화하는 것이다.</p>
<p><img src="/images/rendering-process-2.gif" alt="rendering-process-2"></p>
<p> DOM 트리 및 스타일, 레이아웃 트리, 페인트 트리의 순서로 생성된다</p>
<p>렌더링 파이프라인에서 파악해야 할 가장 중요한 점은 각 단계에서 이전 작업의 결과가 새 데이터를 만드는 데 사용된다는 것이다. 예를 들어 레이아웃 트리에서 변경이 생겨 문서의 일부가 영향을 받으면 페인팅 순서도 새로 생성해야 한다.</p>
<p>요소에 애니메이션을 적용하면 브라우저는 모든 프레임 사이에서 이러한 작업을 해야 한다. 대부분의 디스플레이 장치는 화면을 초당 60번 새로 고친다(60fps). 요소의 움직임이 모든 프레임에 반영되어야 사람이 볼 때 부드럽게 느껴진다. 애니메이션에서 프레임이 누락되면 웹 페이지가 '버벅대는(janky)' 것처럼 보인다.</p>
<p>화면 주사율에 맞추어 렌더링 작업이 이루어져도 이 작업은 메인 스레드에서 실행되기 때문에 애플리케이션이 JavaScript를 실행하는 동안 렌더링이 막힐 수 있다.
JavaScript 작업을 작은 덩어리로 나누고 <code>requestAnimationFrame()</code> 메서드를 사용해 프레임마다 실행하도록 스케줄을 관리할 수 있다.  하지만 이건 JavaScript의 실행을 끊김없이 하는데 도움을 줄 뿐 실제로 메인쓰레드가 수행하는 작업의 양은 줄어들지 않는다.
메인쓰레드가 수행하는 작업의 양을 줄이는 작업이 바로 Reflow와 Repaint를 최소화하는 것이다.</p>
<h2>Reflow(Layout)</h2>
<p>DOM Tree 와 CSSOM로 만든 Render Tree를 바탕으로 DOM을 Viewport 내에 놓일 정확한 위치와 크기를 계산하여 적용하는 단계이다.
이 단계에서는 해당 DOM의 크기와 위치를 계산할 시 주변 노드(부모, 자식)들에 영향을 받게 된다. 따라서 이미 계산된 Layout에서 한 노드만 다시 계산하여도 주변 모든 노드들도 다시 계산하게 된다.
css 에서 다음의 속성들을 건드리게 되면 Reflow단계를 수행하게 된다.</p>
<ul>
<li>padding</li>
<li>margin</li>
<li>display</li>
<li>border</li>
<li>position</li>
<li>float</li>
<li>overflow</li>
<li>font-family</li>
<li>vertical-align</li>
<li>clear</li>
<li>bottom</li>
<li>left</li>
<li>right</li>
<li>font-weight</li>
<li>white-space</li>
<li>etc..</li>
</ul>
<h2>Repaint(Paint)</h2>
<p>Layout에서 계산된 결과를 바탕으로 Viewport에서 픽셀을 채워넣는 단계이다.
밑의 속성들이 변경되면 Repaint 단계가 일어난다.</p>
<ul>
<li>Visibility</li>
<li>background</li>
<li>text-decoration</li>
<li>background-image</li>
<li>background-repeat</li>
<li>border0radius</li>
<li>box-shadow</li>
<li>background-size</li>
<li>etc...</li>
</ul>
<p>만약 기존 CSS에서 background-color만 바꾸게 된다면 Reflow단계를 건너뛰고 Repaint단계만 수행하게 된다.</p>
<h2>Composite</h2>
<p>opacity, transform등의 속성은 Reflow, Repaint 단계를 거치지 않는다.
Reflow, Repaint를 모두 건너 뛰게 되어 연산이 절대적으로 줄게 된다.
따라서 animation을 구현할 때 transform을 통해서 구현하는 것이 성능 상에 이점이 많다.</p>
<p>특히나 Composite의 이점은 메인 스레드와 별개로 작동이 된다. Compositor thread는 JavaScript 실행이나 스타일 계산을 기다리지 않아, Composite만 하는 animation이 성능상 가장 부드럽다고 보는 이유이다.
(Layout이나 Paint를 다시 계산해야할 경우에는 main thread가 관여하게 된다.)</p>
<h2>정리</h2>
<p>animation 성능을 향상(부드러운 animation)시키기 위해서는 Reflow와 Repaint를 최소화하는게 중요하다.
width, height, left, right등의 요소를 사용하기 보다는 다음의 네가지 요소를 이용해서 animation을 구현하자.</p>
<ul>
<li>opacity</li>
<li>translate</li>
<li>rotate</li>
<li>scale</li>
</ul>
<p>실제로 React나 Vue에서 Virtual Dom을 사용하는 이유가 Reflow, Repaint를 여러번 하지않고, 모아서 한꺼번에 처리해 성능을 높히기 위함이다.</p>
<p>경우에 따라서는 Reflow를 해야만 하는 경우가 있다. 이러한 경우에는 해당 node를 position: absolute or fixed로 변경하는게 좋다. 그 이유는 Reflow를 사용할 시 부모, 자식등 영향을 받는 모든 node들이 계산하게 되는데, absolute, fixed일 경우 부모에게 종속되지 않는 새로운 layer에 그려지게 된다.</p>
<p>따라서 만약 해당 node에 reflow가 발생하게 된다면 해당 layer만 새로 업데이트 된다.</p>
<h3>Reference</h3>
<ul>
<li><a href="https://csstriggers.com/">Reflow, Repaint, Composit에 영향을 미치는 속성들을 더 알고싶다면 여기를 참고하자</a> </li>
<li><a href="https://developers.google.com/web/fundamentals/performance/rendering/?hl=ko">Rendering process &#x26; performance에 대한 내용</a></li>
<li><a href="https://developers.google.com/web/fundamentals/performance/critical-rendering-path/render-tree-construction?hl=en">Render-tree Construction, Layout, and Paint</a></li>
<li><a href="https://www.html5rocks.com/en/tutorials/speed/high-performance-animations/">hight performance animation의 조금 더 깊은 내용</a></li>
<li><a href="https://d2.naver.com/helloworld/5237120">최신 브라우저의 내부 살펴보기</a></li>
</ul></div></div><style data-emotion="css 9vkh6d">.css-9vkh6d{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;width:100%;margin-top:48px;}.css-9vkh6d button{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;width:240px;height:48px;border:none;margin:8px auto;border-radius:4px;font-size:16px;font-weight:bold;padding:16px;position:relative;}</style><div class="css-9vkh6d ep629fi2"><style data-emotion="css 1qw3ucq">.css-1qw3ucq{background-color:#e8f3ff;color:#1d6ff2;margin-bottom:16px;}.css-1qw3ucq>svg{position:absolute;left:16px;}</style><button class="like-button css-1qw3ucq ep629fi1"><svg viewBox="0 0 24 24" style="width:20;height:20" role="presentation" class="like-button"><path d="M12.1,18.55L12,18.65L11.89,18.55C7.14,14.24 4,11.39 4,8.5C4,6.5 5.5,5 7.5,5C9.04,5 10.54,6 11.07,7.36H12.93C13.46,6 14.96,5 16.5,5C18.5,5 20,6.5 20,8.5C20,11.39 16.86,14.24 12.1,18.55M16.5,3C14.76,3 13.09,3.81 12,5.08C10.91,3.81 9.24,3 7.5,3C4.42,3 2,5.41 2,8.5C2,12.27 5.4,15.36 10.55,20.03L12,21.35L13.45,20.03C18.6,15.36 22,12.27 22,8.5C22,5.41 19.58,3 16.5,3Z" style="fill:#1d6ff2"></path></svg>LIKE</button><style data-emotion="css qkt14p">.css-qkt14p{background-color:#e5e8ec;color:#535a65;}.css-qkt14p>img{position:absolute;left:16px;}</style><button class="share-button css-qkt14p ep629fi0"><img src="/icon/share.svg" alt="share" height="20" width="20" class="share-button css-0 ep629fi10"/>SHARE</button></div></section></article></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"Height Performace Animations","slug":"height-performace-animations","content":"\u003cp\u003e\u003cimg src=\"/images/rendering-process.jpeg\" alt=\"rendering-process\"\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e출처: \u003ca href=\"https://developers.google.com/web/fundamentals/performance/rendering/?hl=ko\"\u003edevelopers.google.com\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eJS와 CSS를 이용하여 animation을 구현해야할 때 성능 상 가장 고려해야할 부분이 Reflow(Layout) 와 Repaint(Paint)를 최소화하는 것이다.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/images/rendering-process-2.gif\" alt=\"rendering-process-2\"\u003e\u003c/p\u003e\n\u003cp\u003e DOM 트리 및 스타일, 레이아웃 트리, 페인트 트리의 순서로 생성된다\u003c/p\u003e\n\u003cp\u003e렌더링 파이프라인에서 파악해야 할 가장 중요한 점은 각 단계에서 이전 작업의 결과가 새 데이터를 만드는 데 사용된다는 것이다. 예를 들어 레이아웃 트리에서 변경이 생겨 문서의 일부가 영향을 받으면 페인팅 순서도 새로 생성해야 한다.\u003c/p\u003e\n\u003cp\u003e요소에 애니메이션을 적용하면 브라우저는 모든 프레임 사이에서 이러한 작업을 해야 한다. 대부분의 디스플레이 장치는 화면을 초당 60번 새로 고친다(60fps). 요소의 움직임이 모든 프레임에 반영되어야 사람이 볼 때 부드럽게 느껴진다. 애니메이션에서 프레임이 누락되면 웹 페이지가 '버벅대는(janky)' 것처럼 보인다.\u003c/p\u003e\n\u003cp\u003e화면 주사율에 맞추어 렌더링 작업이 이루어져도 이 작업은 메인 스레드에서 실행되기 때문에 애플리케이션이 JavaScript를 실행하는 동안 렌더링이 막힐 수 있다.\nJavaScript 작업을 작은 덩어리로 나누고 \u003ccode\u003erequestAnimationFrame()\u003c/code\u003e 메서드를 사용해 프레임마다 실행하도록 스케줄을 관리할 수 있다.  하지만 이건 JavaScript의 실행을 끊김없이 하는데 도움을 줄 뿐 실제로 메인쓰레드가 수행하는 작업의 양은 줄어들지 않는다.\n메인쓰레드가 수행하는 작업의 양을 줄이는 작업이 바로 Reflow와 Repaint를 최소화하는 것이다.\u003c/p\u003e\n\u003ch2\u003eReflow(Layout)\u003c/h2\u003e\n\u003cp\u003eDOM Tree 와 CSSOM로 만든 Render Tree를 바탕으로 DOM을 Viewport 내에 놓일 정확한 위치와 크기를 계산하여 적용하는 단계이다.\n이 단계에서는 해당 DOM의 크기와 위치를 계산할 시 주변 노드(부모, 자식)들에 영향을 받게 된다. 따라서 이미 계산된 Layout에서 한 노드만 다시 계산하여도 주변 모든 노드들도 다시 계산하게 된다.\ncss 에서 다음의 속성들을 건드리게 되면 Reflow단계를 수행하게 된다.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003epadding\u003c/li\u003e\n\u003cli\u003emargin\u003c/li\u003e\n\u003cli\u003edisplay\u003c/li\u003e\n\u003cli\u003eborder\u003c/li\u003e\n\u003cli\u003eposition\u003c/li\u003e\n\u003cli\u003efloat\u003c/li\u003e\n\u003cli\u003eoverflow\u003c/li\u003e\n\u003cli\u003efont-family\u003c/li\u003e\n\u003cli\u003evertical-align\u003c/li\u003e\n\u003cli\u003eclear\u003c/li\u003e\n\u003cli\u003ebottom\u003c/li\u003e\n\u003cli\u003eleft\u003c/li\u003e\n\u003cli\u003eright\u003c/li\u003e\n\u003cli\u003efont-weight\u003c/li\u003e\n\u003cli\u003ewhite-space\u003c/li\u003e\n\u003cli\u003eetc..\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003eRepaint(Paint)\u003c/h2\u003e\n\u003cp\u003eLayout에서 계산된 결과를 바탕으로 Viewport에서 픽셀을 채워넣는 단계이다.\n밑의 속성들이 변경되면 Repaint 단계가 일어난다.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eVisibility\u003c/li\u003e\n\u003cli\u003ebackground\u003c/li\u003e\n\u003cli\u003etext-decoration\u003c/li\u003e\n\u003cli\u003ebackground-image\u003c/li\u003e\n\u003cli\u003ebackground-repeat\u003c/li\u003e\n\u003cli\u003eborder0radius\u003c/li\u003e\n\u003cli\u003ebox-shadow\u003c/li\u003e\n\u003cli\u003ebackground-size\u003c/li\u003e\n\u003cli\u003eetc...\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e만약 기존 CSS에서 background-color만 바꾸게 된다면 Reflow단계를 건너뛰고 Repaint단계만 수행하게 된다.\u003c/p\u003e\n\u003ch2\u003eComposite\u003c/h2\u003e\n\u003cp\u003eopacity, transform등의 속성은 Reflow, Repaint 단계를 거치지 않는다.\nReflow, Repaint를 모두 건너 뛰게 되어 연산이 절대적으로 줄게 된다.\n따라서 animation을 구현할 때 transform을 통해서 구현하는 것이 성능 상에 이점이 많다.\u003c/p\u003e\n\u003cp\u003e특히나 Composite의 이점은 메인 스레드와 별개로 작동이 된다. Compositor thread는 JavaScript 실행이나 스타일 계산을 기다리지 않아, Composite만 하는 animation이 성능상 가장 부드럽다고 보는 이유이다.\n(Layout이나 Paint를 다시 계산해야할 경우에는 main thread가 관여하게 된다.)\u003c/p\u003e\n\u003ch2\u003e정리\u003c/h2\u003e\n\u003cp\u003eanimation 성능을 향상(부드러운 animation)시키기 위해서는 Reflow와 Repaint를 최소화하는게 중요하다.\nwidth, height, left, right등의 요소를 사용하기 보다는 다음의 네가지 요소를 이용해서 animation을 구현하자.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eopacity\u003c/li\u003e\n\u003cli\u003etranslate\u003c/li\u003e\n\u003cli\u003erotate\u003c/li\u003e\n\u003cli\u003escale\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e실제로 React나 Vue에서 Virtual Dom을 사용하는 이유가 Reflow, Repaint를 여러번 하지않고, 모아서 한꺼번에 처리해 성능을 높히기 위함이다.\u003c/p\u003e\n\u003cp\u003e경우에 따라서는 Reflow를 해야만 하는 경우가 있다. 이러한 경우에는 해당 node를 position: absolute or fixed로 변경하는게 좋다. 그 이유는 Reflow를 사용할 시 부모, 자식등 영향을 받는 모든 node들이 계산하게 되는데, absolute, fixed일 경우 부모에게 종속되지 않는 새로운 layer에 그려지게 된다.\u003c/p\u003e\n\u003cp\u003e따라서 만약 해당 node에 reflow가 발생하게 된다면 해당 layer만 새로 업데이트 된다.\u003c/p\u003e\n\u003ch3\u003eReference\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://csstriggers.com/\"\u003eReflow, Repaint, Composit에 영향을 미치는 속성들을 더 알고싶다면 여기를 참고하자\u003c/a\u003e \u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://developers.google.com/web/fundamentals/performance/rendering/?hl=ko\"\u003eRendering process \u0026#x26; performance에 대한 내용\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://developers.google.com/web/fundamentals/performance/critical-rendering-path/render-tree-construction?hl=en\"\u003eRender-tree Construction, Layout, and Paint\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.html5rocks.com/en/tutorials/speed/high-performance-animations/\"\u003ehight performance animation의 조금 더 깊은 내용\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://d2.naver.com/helloworld/5237120\"\u003e최신 브라우저의 내부 살펴보기\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","tags":[{"slug":"web","name":"Web"}]}},"__N_SSG":true},"page":"/posts/[slug]","query":{"slug":"height-performace-animations"},"buildId":"xkz6IyzL6zBvbmuywHbEE","nextExport":false,"isFallback":false,"gsp":true}</script><script nomodule="" src="/_next/static/chunks/polyfills-af28de04c604a2479390.js"></script><script src="/_next/static/chunks/main-700352a82f2f881da0df.js" async=""></script><script src="/_next/static/chunks/webpack-50bee04d1dc61f8adf5b.js" async=""></script><script src="/_next/static/chunks/framework.bcd77fe60d2cafeaf060.js" async=""></script><script src="/_next/static/chunks/commons.41740424e3c7ae16de33.js" async=""></script><script src="/_next/static/chunks/6335da8543c52d3af527c387f688061357787349.024b674f35d94beaf7c8.js" async=""></script><script src="/_next/static/chunks/pages/_app-9ca66668ed02ba88465c.js" async=""></script><script src="/_next/static/chunks/b2e984c5.dde205419b836c367968.js" async=""></script><script src="/_next/static/chunks/2c3b9bffc7150b37a7b3810dfcf1c0b0fac2bd18.00ed53c325f730cbfd70.js" async=""></script><script src="/_next/static/chunks/pages/posts/%5Bslug%5D-83b8a4f787f45e6aa6dc.js" async=""></script><script src="/_next/static/xkz6IyzL6zBvbmuywHbEE/_buildManifest.js" async=""></script><script src="/_next/static/xkz6IyzL6zBvbmuywHbEE/_ssgManifest.js" async=""></script></body></html>