{"pageProps":{"post":{"title":"Use WebP images","slug":"use-webp-images","content":"<blockquote>\n<p>구글이 Webp를 만들어서 무료로 뿌리는 이유는 돈 때문이다. 구글 혼자서 엄청난 인터넷 트래픽을 사용하고 있는데, 이미지 포맷만 최적화해도 서버 트래픽이 크게 줄어 서버비를 아낄 수 있다. 게다가 인터넷 속도가 빨라질수록 광고 매출도 늘어나기 때문에 구글은 항상 인터넷 속도를 올리려고 노력한다.</p>\n<p><a href=\"https://namu.wiki/w/WebP\">WebP 제작 배경 :: 나무위키</a></p>\n</blockquote>\n<p>webp 포멧의 이미지는 JPEG 및 PNG 이미지보다 작으며 일반적으로 파일크기가 25~35% 작습니다. 이로인해 First load times를 줄일 수 있습니다</p>\n<ul>\n<li>YouTube는 Thumbnail 이미지를 WebP로 전환한 결과 페이지로드 속도가 10% 빨라졌습니다.</li>\n<li>Facebook은 WebP를 사용하도록 전환했을 때 JPEG와 비교했을 경우 25 ~ 35%, PNG와 비교했을 경우 80%의 파일크기 절감을 경험했습니다.</li>\n</ul>\n<p>WebP는 JPEG, PNG 및 GIF 이미지를 완전히 대체할 수 있으며, lossless and lossy compression 을 모두 지원합니다. <code>lossless compression</code> 은 데이터의 손실이 발생하지않고 <code>lossy compression</code>는 파일크기가 줄어들고 이미지 화질을 떨어지게 하는 압축입니다.</p>\n<h2>Convert images to WebP</h2>\n<p>이미지를 WebP로 변환할 때 보통 <a href=\"https://developers.google.com/speed/webp/docs/using\">cwebp command-line tool</a> 와 <a href=\"https://github.com/imagemin/imagemin-webp\">Imagemin WebP plugin</a>을 사용합니다. Imagemin WebP plugin은 Webpack이나 Gulp와 같은 build tools를 사용하는 프로젝트에 최고의 선택이고 CLI는 image를 한 번만 변환시킬 때 사용하기 좋습니다.</p>\n<p>이미지를 WebP로 변환할 때 다양한 압축 설정을 지정할 수 있지만 가장 중요하게 봐야할 것이 품질수준입니다. 0(최약)에서 100(최상)까지 품질 수준을 지정할 수 있기에 필요에 맞는 이미지 품질과 파일크기를 고려하여 선택하면 됩니다.</p>\n<h3>Use cwebp</h3>\n<p>간단히 하나의 파일을 변경할 때는 cwebp를 사용하면 됩니다.</p>\n<p>default:</p>\n<pre class=\"language-bash\"><code class=\"language-bash\">cwebp images/flower.jpg -o images/flower.webp\n</code></pre>\n<p>using a query level of <code>50</code>:</p>\n<pre class=\"language-bash\"><code class=\"language-bash\">cwebp -q <span class=\"token number\">50</span> images/flower.jpg -o images/flower.webp\n</code></pre>\n<p>Convert all files in a directory:</p>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token keyword\">for</span> <span class=\"token for-or-select variable\">file</span> <span class=\"token keyword\">in</span> images/*<span class=\"token punctuation\">;</span> <span class=\"token keyword\">do</span> cwebp <span class=\"token string\">\"<span class=\"token variable\">$file</span>\"</span> -o <span class=\"token string\">\"<span class=\"token variable\">${file<span class=\"token operator\">%</span>.*}</span>.webp\"</span><span class=\"token punctuation\">;</span> <span class=\"token keyword\">done</span>\n</code></pre>\n<h3>Use Imagemin</h3>\n<p>Imagemin은 Webpack과 같은 build tools를 사용하는 프로젝트에서 사용하기 좋습니다.</p>\n<p>간단히 <a href=\"https://www.npmjs.com/package/imagemin-webp-webpack-plugin\">imagemin-webp-webpack-plugin</a>을 사용하면 될 것 같습니다.</p>\n<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> <span class=\"token maybe-class-name\">ImageminWebpWebpackPlugin</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"imagemin-webp-webpack-plugin\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nmodule<span class=\"token punctuation\">.</span><span class=\"token property-access\">exports</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  plugins<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">ImageminWebpWebpackPlugin</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n</code></pre>\n<h2>Serve WebP images</h2>\n<p>만약 WebP를 제공하지 않는 <a href=\"https://caniuse.com/?search=webp\">브라우저</a>라면 fallback을 설정할 수도 있습니다.</p>\n<h4>Before:</h4>\n<pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&#x3C;</span>img</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>flower.jpg<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">alt</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span><span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n</code></pre>\n<h4>After:</h4>\n<pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&#x3C;</span>picture</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&#x3C;</span>source</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>image/webp<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">srcset</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>flower.webp<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&#x3C;</span>source</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>image/jpeg<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">srcset</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>flower.jpg<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&#x3C;</span>img</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>flower.jpg<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">alt</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span><span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&#x3C;/</span>picture</span><span class=\"token punctuation\">></span></span>\n</code></pre>\n<p><code>&#x3C;picture></code>안의 <code>&#x3C;source></code> 및 <code>&#x3C;img></code> 태그는 상위에 대한 fallback입니다.</p>\n<h3>picture</h3>\n<p><code>&#x3C;picture></code>는 0개 이상의 <code>&#x3C;source></code>와 하나의 <code>&#x3C;img></code> 태그의 wrapper입니다.</p>\n<h3>source</h3>\n<p><code>&#x3C;source></code> 태그는 미디어 리소스를 지정합니다.</p>\n<p>브라우저에 지원되는 형식을 순서대로 따라가며, 만약 지원하지 않는 경우 <code>&#x3C;img></code> 태그에 지정된 이미지로 대체됩니다.</p>\n<h3>image</h3>\n<p><code>&#x3C;img></code>의 경우 <code>&#x3C;picture></code> 태그를 지원하지 않는 경우 <code>&#x3C;img></code> 태그의 image를 로드하게 됩니다.</p>\n<h2>Verify WebP usage</h2>\n<p>Lighthouse는 사이트의 모든 이미지가 WebP를 사용하지는 체크하고, 사용하지 않는 이미지를 나열합니다.</p>\n<h2>Reference</h2>\n<ul>\n<li><a href=\"https://web.dev/serve-images-webp/\">Use WebP images :: WebDev</a></li>\n</ul>","tags":[{"slug":"web","name":"Web"}]}},"__N_SSG":true}